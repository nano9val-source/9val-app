<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>9VAl BATTLE | LIVE SYSTEM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --accent: #ff9f0a; --bg: #000; --card: #1c1c1e; --text: #fff;
            --dim: #8e8e93; --green: #34c759; --red: #ff453a; --border: #2c2c2e;
            --insta: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 120px; }

        /* –ù–ê–í–Ü–ì–ê–¶–Ü–Ø (6 –í–ö–õ–ê–î–û–ö) */
        .tab-bar { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(10,10,10,0.98); backdrop-filter: blur(20px); display: flex; padding: 12px 5px 35px; border-top: 0.5px solid var(--border); z-index: 9999; }
        .tab-item { color: var(--dim); font-size: 9px; text-align: center; flex: 1; cursor: pointer; font-weight: 700; text-transform: uppercase; }
        .tab-item.active { color: var(--accent); }
        .tab-icon { font-size: 22px; display: block; margin-bottom: 4px; }

        .page { display: none; padding: 20px; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .glass-card { background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 15px; border: 1px solid var(--border); }
        input, textarea { width: 100%; padding: 16px; margin: 10px 0; background: #262629; border: 1px solid #3a3a3c; border-radius: 14px; color: #fff; font-size: 16px; }
        .btn { background: var(--accent); color: #000; border: none; padding: 18px; border-radius: 16px; width: 100%; font-weight: 800; cursor: pointer; }
        .btn:disabled { background: #333; color: #666; cursor: not-allowed; }

        /* –°–£–î–î–Ü */
        .judge-row { display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid var(--border); }
        .judge-img { width: 55px; height: 55px; border-radius: 50%; border: 2px solid var(--accent); margin-right: 15px; background: #333; }
        .insta-btn { width: 40px; height: 40px; background: var(--insta); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-left: auto; text-decoration: none; font-size: 18px; color: white; }

        /* –û–¶–Ü–ù–ö–ò –¢–ê –†–ï–ô–¢–ò–ù–ì */
        .v-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .v-box { background: #000; padding: 10px; border-radius: 12px; border: 1px solid #333; text-align: center; }
        .v-box label { font-size: 9px; color: var(--dim); display: block; margin-bottom: 4px; }
        .v-box input { background: none; border: none; font-size: 22px; font-weight: 900; color: var(--accent); text-align: center; width: 100%; }
        
        .rank-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #222; }
        .rank-val { color: var(--accent); font-weight: 900; font-size: 20px; }
        
        audio { width: 100%; height: 35px; filter: invert(1); margin-top: 10px; }
        .loading { text-align: center; padding: 20px; color: var(--accent); font-weight: bold; }
    </style>
</head>
<body>

    <div id="p-home" class="page active">
        <h1 id="cms-title">9VAl BATTLE</h1>
        <div class="glass-card">
            <h3 id="cms-prize" style="color:var(--accent); margin-top:0;">–ü–†–ò–ó: 50 000 –ì–†–ù</h3>
            <p id="cms-desc">–ó–∞–≤–∞–Ω—Ç–∞–∂—É–π —Å–≤—ñ–π –Ω–∞–π–∫—Ä–∞—â–∏–π —Ç—Ä–µ–∫ —Ç–∞ –¥–æ–≤–µ–¥–∏, —â–æ —Ç–∏ –Ω–æ–º–µ—Ä –æ–¥–∏–Ω.</p>
        </div>
        <div class="glass-card" style="border-left: 4px solid var(--green)">
            <b>–°–¢–ê–¢–£–°:</b> –ü–†–ò–ô–û–ú –¢–†–ï–ö–Ü–í –í–Ü–î–ö–†–ò–¢–û
        </div>
    </div>

    <div id="p-judges" class="page">
        <h2>–ñ–£–†–Ü</h2>
        <div class="glass-card">
            <div class="judge-row">
                <div class="judge-img"></div>
                <div><b>TONY MUS1CZ</b><br><small>Producer</small></div>
                <a href="https://instagram.com/t0ny_mus1cz_prod/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-row">
                <div class="judge-img"></div>
                <div><b>NeedForRap</b><br><small>Analyst</small></div>
                <a href="https://instagram.com/aleksandr_kozlovvvvv/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-row">
                <div class="judge-img"></div>
                <div><b>Nano</b><br><small>CEO</small></div>
                <a href="https://instagram.com/nano9val/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-row" style="border:0">
                <div class="judge-img"></div>
                <div><b>KAZHAN</b><br><small>Artist</small></div>
                <a href="https://instagram.com/ka.zhan_/" class="insta-btn">üì∏</a>
            </div>
        </div>
    </div>

    <div id="p-player" class="page">
        <h2>–£–ß–ê–°–ù–ò–ö–ò</h2>
        <div id="tracks-live">
            <div class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—Ä–µ–∫—ñ–≤...</div>
        </div>
    </div>

    <div id="p-stats" class="page">
        <h2>–¢–£–†–ù–Ü–†–ù–ê –¢–ê–ë–õ–ò–¶–Ø</h2>
        <div class="glass-card" style="padding:0" id="ranking-live">
            <div class="loading">–û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—É...</div>
        </div>
    </div>

    <div id="p-reg" class="page">
        <h2>–£–ß–ê–°–¢–¨</h2>
        <div class="glass-card">
            <input type="text" id="r-nick" placeholder="–¢–≤—ñ–π –ù—ñ–∫">
            <input type="text" id="r-city" placeholder="–ú—ñ—Å—Ç–æ">
            <input type="file" id="r-file" accept="audio/*">
            <div style="display:flex; gap:12px; margin: 20px 0; align-items: center;">
                <input type="checkbox" id="r-check" style="width:24px; height:24px;" onchange="document.getElementById('r-btn').disabled = !this.checked">
                <label style="font-size:11px; color:var(--dim)">–Ø –∑–≥–æ–¥–µ–Ω –∑ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±–∞—Ç–ª—É</label>
            </div>
            <button class="btn" id="r-btn" disabled onclick="app.uploadTrack()">–í–Ü–î–ü–†–ê–í–ò–¢–ò</button>
        </div>
    </div>

    <div id="p-admin" class="page">
        <div id="adm-auth">
            <h2>–í–•–Ü–î –ñ–£–†–Ü</h2>
            <div class="glass-card">
                <input type="text" id="a-login" placeholder="–õ–æ–≥—ñ–Ω">
                <input type="password" id="a-pass" placeholder="–ü–∞—Ä–æ–ª—å">
                <button class="btn" onclick="app.login()">–£–í–Ü–ô–¢–ò</button>
            </div>
        </div>
        <div id="adm-panel" style="display:none;">
            <h3>–†–ï–î–ê–ö–¢–û–† CMS</h3>
            <div class="glass-card">
                <input type="text" id="e-t" placeholder="–ù–∞–∑–≤–∞ –±–∞—Ç–ª—É">
                <input type="text" id="e-p" placeholder="–ü—Ä–∏–∑">
                <textarea id="e-d" placeholder="–û–ø–∏—Å"></textarea>
                <button class="btn" onclick="app.saveCMS()">–û–ù–û–í–ò–¢–ò –ö–û–ù–¢–ï–ù–¢</button>
            </div>
            <h3>–ú–û–î–ï–†–ê–¶–Ü–Ø –¢–ê –û–¶–Ü–ù–ö–ò</h3>
            <div id="adm-list"></div>
        </div>
    </div>

    <nav class="tab-bar">
        <div class="tab-item active" onclick="app.nav('home', this)"><span class="tab-icon">üè†</span>–ì–û–õ–û–í–ù–ê</div>
        <div class="tab-item" onclick="app.nav('judges', this)"><span class="tab-icon">‚öñÔ∏è</span>–°–£–î–î–Ü</div>
        <div class="tab-item" onclick="app.nav('player', this)"><span class="tab-icon">üéß</span>–ü–õ–ï–Ñ–†</div>
        <div class="tab-item" onclick="app.nav('stats', this)"><span class="tab-icon">üìä</span>–¢–ê–ë–õ–ò–¶–Ø</div>
        <div class="tab-item" onclick="app.nav('reg', this)"><span class="tab-icon">üé§</span>–£–ß–ê–°–¢–¨</div>
        <div class="tab-item" onclick="app.nav('admin', this)"><span class="tab-icon">üõ°Ô∏è</span>–ê–î–ú–Ü–ù</div>
    </nav>

    <script>
        const API_URL = "–¢–í–Ü–ô_URL_GOOGLE_SCRIPT"; // –°—é–¥–∏ –≤—Å—Ç–∞–≤–∏—à –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–∫—Ä–∏–ø—Ç —Ç–∞–±–ª–∏—Ü—ñ

        const app = {
            data: [], 
            nav(id, el) {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                document.getElementById('p-' + id).classList.add('active');
                el.classList.add('active');
            },
            login() {
                if(document.getElementById('a-login').value === 'admin' && document.getElementById('a-pass').value === '123') {
                    document.getElementById('adm-auth').style.display = 'none';
                    document.getElementById('adm-panel').style.display = 'block';
                    this.renderAdmin();
                } else { alert("–ü–æ–º–∏–ª–∫–∞ –¥–æ—Å—Ç—É–ø—É"); }
            },
            // –§–£–ù–ö–¶–Ü–Ø –ü–Ü–î–†–ê–•–£–ù–ö–£ –¢–ê–ë–õ–ò–¶–Ü
            renderRanking() {
                const container = document.getElementById('ranking-live');
                // –°–æ—Ä—Ç—É—î–º–æ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–º –±–∞–ª–æ–º
                const sorted = [...this.data].sort((a, b) => b.avg - a.avg);
                container.innerHTML = sorted.map((u, i) => `
                    <div class="rank-item">
                        <span>${i+1}. ${u.name}</span>
                        <span class="rank-val">${u.avg.toFixed(1)}</span>
                    </div>
                `).join('') || '<div class="loading">–£—á–∞—Å–Ω–∏–∫—ñ–≤ —â–µ –Ω–µ–º–∞—î</div>';
            },
            // –§–£–ù–ö–¶–Ü–Ø –û–ù–û–í–õ–ï–ù–ù–Ø –ü–õ–ï–Ñ–†–ê
            renderPlayer() {
                const container = document.getElementById('tracks-live');
                container.innerHTML = this.data.filter(u => u.status === 'active').map(u => `
                    <div class="glass-card">
                        <div style="display:flex; justify-content:space-between"><b>${u.name}</b><b>${u.avg.toFixed(1)}</b></div>
                        <audio src="${u.fileUrl}" controls></audio>
                    </div>
                `).join('') || '<div class="loading">–¢—Ä–µ–∫–∏ –∑‚Äô—è–≤–ª—è—Ç—å—Å—è –ø—ñ—Å–ª—è –º–æ–¥–µ—Ä–∞—Ü—ñ—ó</div>';
            },
            // –õ–û–ì–Ü–ö–ê –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø 4 –û–¶–Ü–ù–û–ö
            saveScore(id) {
                const t = document.getElementById('t'+id).value;
                const f = document.getElementById('f'+id).value;
                const p = document.getElementById('p'+id).value;
                const v = document.getElementById('v'+id).value;
                const avg = (Number(t) + Number(f) + Number(p) + Number(v)) / 4;
                alert(`–ó–±–µ—Ä–µ–∂–µ–Ω–æ! –°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª: ${avg.toFixed(1)}`);
                // –¢—É—Ç —ñ–¥–µ –∑–∞–ø–∏—Ç –¥–æ Google Sheets
            },
            saveCMS() {
                alert("–î–∞–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ –≤ –±–∞–∑—ñ!");
            }
        };

        window.onload = () => {
            window.Telegram.WebApp.expand();
            // –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ, —â–æ–± —Ç–∏ –±–∞—á–∏–≤ —è–∫ –ø—Ä–∞—Ü—é—î —Ç—É—Ä–Ω—ñ—Ä–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –≤—ñ–¥—Ä–∞–∑—É
            app.data = [
                {name: "Winner MC", avg: 9.8, status: "active", fileUrl: ""},
                {name: "Flow Master", avg: 8.5, status: "active", fileUrl: ""}
            ];
            app.renderRanking();
            app.renderPlayer();
        };
    </script>
</body>
</html>
