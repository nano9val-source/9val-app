<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>9VAl BATTLE | ULTIMATE SYSTEM</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --accent: #ff9f0a; --bg: #000; --card: #1c1c1e; --text: #fff;
            --dim: #8e8e93; --green: #34c759; --red: #ff453a; --border: #2c2c2e;
            --insta: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 110px; overflow-x: hidden; }

        /* --- 6 –í–ö–õ–ê–î–û–ö –ù–ê–í–Ü–ì–ê–¶–Ü–Ø --- */
        .tab-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(20px);
            display: flex; justify-content: space-around; padding: 12px 5px 35px;
            border-top: 0.5px solid var(--border); z-index: 10000;
        }
        .tab-item { color: var(--dim); font-size: 9px; text-align: center; flex: 1; cursor: pointer; transition: 0.2s; font-weight: 700; }
        .tab-item.active { color: var(--accent); }
        .tab-icon { font-size: 22px; display: block; margin-bottom: 4px; }

        /* --- –ü–ï–†–ï–ú–ò–ö–ê–ù–ù–Ø –°–¢–û–†–Ü–ù–û–ö --- */
        .page { display: none; padding: 20px; animation: slideUp 0.3s ease; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI –ï–õ–ï–ú–ï–ù–¢–ò --- */
        .glass-card { background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 15px; border: 1px solid var(--border); }
        h1, h2 { font-weight: 900; letter-spacing: -1px; margin-top: 0; }
        
        input, textarea { width: 100%; padding: 16px; margin: 10px 0; background: #262629; border: 1px solid #3a3a3c; border-radius: 14px; color: #fff; font-size: 16px; outline: none; }
        input:focus { border-color: var(--accent); }
        
        .btn { background: var(--accent); color: #000; border: none; padding: 18px; border-radius: 16px; width: 100%; font-weight: 800; cursor: pointer; transition: 0.3s; }
        .btn:disabled { background: #333; color: #666; cursor: not-allowed; }
        .btn:active { transform: scale(0.97); }

        /* --- –°–£–î–î–Ü (4 –û–°–û–ë–ò) --- */
        .judge-card { display: flex; align-items: center; padding: 15px 0; border-bottom: 1px solid var(--border); }
        .judge-img { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--accent); margin-right: 15px; background: #333; overflow: hidden; }
        .judge-info b { font-size: 18px; display: block; }
        .judge-info span { color: var(--dim); font-size: 13px; }
        .insta-btn { width: 40px; height: 40px; background: var(--insta); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-left: auto; text-decoration: none; }

        /* --- 4 –û–¶–Ü–ù–ö–ò (PRO) --- */
        .vote-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 15px 0; }
        .vote-item { background: #000; padding: 12px; border-radius: 15px; border: 1px solid #333; text-align: center; }
        .vote-item label { font-size: 10px; color: var(--dim); display: block; margin-bottom: 5px; text-transform: uppercase; }
        .vote-item input { background: transparent; border: none; text-align: center; font-size: 24px; font-weight: 900; color: var(--accent); margin: 0; padding: 0; }

        /* --- –ü–õ–ï–Ñ–† –¢–ê –†–ï–ô–¢–ò–ù–ì --- */
        audio { width: 100%; height: 35px; filter: invert(1); margin-top: 15px; }
        .rank-table { width: 100%; border-collapse: collapse; }
        .rank-table td { padding: 15px 10px; border-bottom: 1px solid var(--border); }
        .rank-num { color: var(--accent); font-weight: 900; width: 30px; }
        .rank-score { text-align: right; font-weight: 800; }

        /* --- –ê–î–ú–Ü–ù-–ú–ï–ù–Æ --- */
        .admin-nav { display: flex; gap: 10px; margin-bottom: 20px; }
        .admin-nav button { flex: 1; padding: 12px; border-radius: 12px; border: none; background: #2c2c2e; color: #fff; font-weight: 700; }
        .admin-nav button.active { background: var(--accent); color: #000; }
    </style>
</head>
<body>

    <div id="p-home" class="page active">
        <h1 id="cms-battle-name">9VAl BATTLE</h1>
        <div class="glass-card">
            <h3 id="cms-prize-text" style="color: var(--accent); margin-top:0;">–ü–†–ò–ó: 50 000 –ì–†–ù</h3>
            <p id="cms-battle-desc">–¢—É—Ç –Ω–∞—Ä–æ–¥–∂—É—é—Ç—å—Å—è –ª–µ–≥–µ–Ω–¥–∏. –†–µ—î—Å—Ç—Ä—É–π—Å—è, –∑–∞–≤–∞–Ω—Ç–∞–∂—É–π —Ç—Ä–µ–∫ —ñ –Ω–µ—Ö–∞–π —Ç–≤—ñ–π –≥–æ–ª–æ—Å –ø–æ—á—É—î –≤—Å—è –∫—Ä–∞—ó–Ω–∞.</p>
        </div>
        <div class="glass-card" style="border-left: 4px solid var(--green);">
            <b style="color: var(--green)">–°–¢–ê–¢–£–°:</b> –ü–†–ò–ô–û–ú –¢–†–ï–ö–Ü–í –í–Ü–î–ö–†–ò–¢–û
        </div>
    </div>

    <div id="p-judges" class="page">
        <h2>–ñ–£–†–Ü</h2>
        <div class="glass-card" style="padding: 5px 20px;">
            <div class="judge-card">
                <div class="judge-img"></div>
                <div class="judge-info"><b>TONY MUS1CZ</b><span>Sound Producer</span></div>
                <a href="https://instagram.com/t0ny_mus1cz_prod/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-card">
                <div class="judge-img"></div>
                <div class="judge-info"><b>NeedForRap</b><span>Rap Analyst</span></div>
                <a href="https://instagram.com/aleksandr_kozlovvvvv/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-card">
                <div class="judge-img"></div>
                <div class="judge-info"><b>Nano</b><span>CEO 9VAl</span></div>
                <a href="https://instagram.com/nano9val/" class="insta-btn">üì∏</a>
            </div>
            <div class="judge-card" style="border:none">
                <div class="judge-img"></div>
                <div class="judge-info"><b>KAZHAN</b><span>Artist</span></div>
                <a href="https://instagram.com/ka.zhan_/" class="insta-btn">üì∏</a>
            </div>
        </div>
    </div>

    <div id="p-player" class="page">
        <h2>–ü–õ–ï–Ñ–†</h2>
        <input type="text" id="track-search" placeholder="üîç –ü–æ—à—É–∫ –∑–∞ –Ω—ñ–∫–æ–º..." oninput="app.render()">
        <div id="player-container"></div>
    </div>

    <div id="p-stats" class="page">
        <h2>–†–ï–ô–¢–ò–ù–ì</h2>
        <div class="glass-card" style="padding:0">
            <table class="rank-table" id="ranking-list"></table>
        </div>
    </div>

    <div id="p-reg" class="page">
        <h2>–ü–û–î–ê–¢–ò –¢–†–ï–ö</h2>
        <div class="glass-card">
            <p id="cms-rules-text" style="font-size: 13px; color: var(--dim); line-height: 1.5;">–ü—Ä–∞–≤–∏–ª–∞: MP3 —Ñ–∞–π–ª, –¥–æ 2 —Ö–≤–∏–ª–∏–Ω. –¢—ñ–ª—å–∫–∏ –∞–≤—Ç–æ—Ä—Å—å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç.</p>
            <input type="text" id="reg-nick" placeholder="–¢–≤—ñ–π –ù—ñ–∫–Ω–µ–π–º">
            <input type="text" id="reg-city" placeholder="–¢–≤–æ—î –ú—ñ—Å—Ç–æ">
            <label style="font-size: 12px; color: var(--accent); margin-top: 10px; display: block;">–§–ê–ô–õ (MP3):</label>
            <input type="file" id="reg-file" accept="audio/mpeg">
            
            <div style="display:flex; gap:12px; margin: 25px 0; align-items: flex-start;">
                <input type="checkbox" id="reg-agree" style="width:24px; height:24px;" onchange="app.toggleReg()">
                <label style="font-size: 12px; color: #8e8e93;">–Ø –∑–≥–æ–¥–µ–Ω –∑ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±–∞—Ç–ª—É —Ç–∞ –¥–∞—é –∑–≥–æ–¥—É –Ω–∞ –æ–±—Ä–æ–±–∫—É –º–æ—ó—Ö –¥–∞–Ω–∏—Ö.</label>
            </div>
            <button class="btn" id="reg-submit" disabled onclick="app.upload()">–í–Ü–î–ü–†–ê–í–ò–¢–ò</button>
        </div>
    </div>

    <div id="p-admin" class="page">
        <div id="admin-auth">
            <h2>–í–•–Ü–î –ñ–£–†–Ü</h2>
            <div class="glass-card">
                <input type="password" id="adm-pass" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å">
                <button class="btn" onclick="app.login()">–£–í–Ü–ô–¢–ò –ü–ê–ù–ï–õ–¨</button>
            </div>
        </div>

        <div id="admin-panel" style="display:none;">
            <div class="admin-nav">
                <button id="btn-mode-vote" class="active" onclick="app.setAdmMode('vote')">–û–¶–Ü–ù–ö–ò</button>
                <button id="btn-mode-cms" onclick="app.setAdmMode('cms')">–ö–û–ù–¢–ï–ù–¢</button>
            </div>

            <div id="adm-vote-view">
                <div id="moderation-list"></div>
            </div>

            <div id="adm-cms-view" style="display:none;">
                <div class="glass-card">
                    <label>–ù–∞–∑–≤–∞ –±–∞—Ç–ª—É</label><input type="text" id="edit-name">
                    <label>–ü—Ä–∏–∑</label><input type="text" id="edit-prize">
                    <label>–û–ø–∏—Å</label><textarea id="edit-desc" rows="3"></textarea>
                    <label>–ü—Ä–∞–≤–∏–ª–∞</label><textarea id="edit-rules" rows="3"></textarea>
                    <button class="btn" onclick="app.saveCMS()">–ó–ë–ï–†–ï–ì–¢–ò –¢–ï–ö–°–¢–ò</button>
                </div>
            </div>
        </div>
    </div>

    <nav class="tab-bar">
        <div class="tab-item active" onclick="app.nav('home', this)"><span class="tab-icon">üè†</span>–ì–û–õ–û–í–ù–ê</div>
        <div class="tab-item" onclick="app.nav('judges', this)"><span class="tab-icon">‚öñÔ∏è</span>–°–£–î–î–Ü</div>
        <div class="tab-item" onclick="app.nav('player', this)"><span class="tab-icon">üéß</span>–ü–õ–ï–Ñ–†</div>
        <div class="tab-item" onclick="app.nav('stats', this)"><span class="tab-icon">üìä</span>–†–ï–ô–¢–ò–ù–ì</div>
        <div class="tab-item" onclick="app.nav('reg', this)"><span class="tab-icon">üé§</span>–£–ß–ê–°–¢–¨</div>
        <div class="tab-item" onclick="app.nav('admin', this)"><span class="tab-icon">üõ°Ô∏è</span>–ê–î–ú–Ü–ù</div>
    </nav>

    <script>
        const API = "–¢–í–Ü–ô_URL_–°–ö–†–ò–ü–¢–ê";
        const app = {
            data: { users: [], cms: {} },
            nav(id, el) {
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
                document.getElementById('p-' + id).classList.add('active');
                el.classList.add('active');
                if(window.Telegram.WebApp.HapticFeedback) window.Telegram.WebApp.HapticFeedback.impactOccurred('light');
            },
            login() {
                if(document.getElementById('adm-pass').value === '123') {
                    document.getElementById('admin-auth').style.display = 'none';
                    document.getElementById('admin-panel').style.display = 'block';
                    this.initCMSFields();
                } else { alert("–î–æ—Å—Ç—É–ø –∑–∞–∫—Ä–∏—Ç–∏–π"); }
            },
            toggleReg() {
                document.getElementById('reg-submit').disabled = !document.getElementById('reg-agree').checked;
            },
            setAdmMode(m) {
                document.getElementById('adm-vote-view').style.display = m === 'vote' ? 'block' : 'none';
                document.getElementById('adm-cms-view').style.display = m === 'cms' ? 'block' : 'none';
                document.getElementById('btn-mode-vote').className = m === 'vote' ? 'active' : '';
                document.getElementById('btn-mode-cms').className = m === 'cms' ? 'active' : '';
            },
            initCMSFields() {
                document.getElementById('edit-name').value = document.getElementById('cms-battle-name').innerText;
                document.getElementById('edit-prize').value = document.getElementById('cms-prize-text').innerText;
                document.getElementById('edit-desc').value = document.getElementById('cms-battle-desc').innerText;
                document.getElementById('edit-rules').value = document.getElementById('cms-rules-text').innerText;
            },
            saveCMS() {
                document.getElementById('cms-battle-name').innerText = document.getElementById('edit-name').value;
                document.getElementById('cms-prize-text').innerText = document.getElementById('edit-prize').value;
                document.getElementById('cms-battle-desc').innerText = document.getElementById('edit-desc').value;
                document.getElementById('cms-rules-text').innerText = document.getElementById('edit-rules').value;
                alert("–ö–æ–Ω—Ç–µ–Ω—Ç –æ–Ω–æ–≤–ª–µ–Ω–æ!");
            },
            render() {
                // –¢—É—Ç –±—É–¥–µ –ª–æ–≥—ñ–∫–∞ –≤–∏–≤–æ–¥—É —Å–ø–∏—Å–∫—É —Ç—Ä–µ–∫—ñ–≤ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥—É –∑ Google Sheets
            }
        };
        window.onload = () => { window.Telegram.WebApp.expand(); };
    </script>
</body>
</html>
